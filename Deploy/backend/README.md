# Backend API Service

–ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—â–∏–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª—ã –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø, –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã (Adapter, VLM) –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ .dockerignore
‚îî‚îÄ‚îÄ README.md
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ü—Ä–∏–µ–º —Ñ–∞–π–ª–æ–≤** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∏–∞–≥—Ä–∞–º–º
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–∞
3. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è** - –≤—ã–∑–æ–≤ Adapter Service –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
4. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ VLM Service –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
5. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è** - —Å–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - healthcheck –∏ –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–±–æ—Ç—ã

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é):**
- `.png`
- `.jpg`, `.jpeg`
- `.gif`
- `.bmp`

**–î–∏–∞–≥—Ä–∞–º–º—ã (—Ç—Ä–µ–±—É—é—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏):**
- `.bpmn` - BPMN –¥–∏–∞–≥—Ä–∞–º–º—ã
- `.puml` - PlantUML
- `.mmd` - Mermaid
- `.drawio` - Draw.io

## API Endpoints

### POST /api/v1/process

–û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∏–∞–≥—Ä–∞–º–º.

**Request:**
```bash
curl -X POST "http://localhost:8000/api/v1/process" \
  -F "file=@diagram.png"
```

**Response:**
```json
{
  "description": "| ‚Ññ | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è | –†–æ–ª—å |\n|---|---|---|\n| 1 | –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ | –°–∏—Å—Ç–µ–º–∞ |",
  "metadata": {
    "file_name": "diagram.png",
    "file_type": ".png",
    "file_size_kb": 125.43,
    "file_hash": "a1b2c3d4e5f6...",
    "converted": false,
    "processing_time": 8.52,
    "timestamp": "2026-02-04T19:15:30.123456",
    "inference_time": 7.52,
    "generation_time": 6.89,
    "image_size": [1024, 768],
    "model": "Qwen/Qwen3-VL-2B-Instruct",
    "device": "cpu"
  }
}
```

### GET /health

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

**Response:**
```json
{
  "status": "healthy",
  "services": {
    "vlm": "healthy",
    "adapter": "healthy"
  },
  "timestamp": "2026-02-04T19:15:30.123456"
}
```

–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:
- `healthy` - –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã
- `degraded` - VLM Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–∫—Ä–∏—Ç–∏—á–Ω–æ)
- `unhealthy` - —Å–µ—Ä–≤–∏—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### GET /metrics

–ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞.

**Response:**
```json
{
  "total_requests": 142,
  "successful_requests": 138,
  "failed_requests": 4,
  "success_rate": 97.18
}
```

### GET /

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö.

### GET /docs

Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è FastAPI).

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t backend-api:latest .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -d \
  --name backend-api \
  -p 8000:8000 \
  -e VLM_SERVICE_URL=http://vlm-inference:8002 \
  -e ADAPTER_SERVICE_URL=http://adapter:8001 \
  -e REQUEST_TIMEOUT=120 \
  backend-api:latest
```

### –ó–∞–ø—É—Å–∫ —Å docker-compose

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
docker-compose up -d backend
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|----------------------|
| `VLM_SERVICE_URL` | URL VLM Inference Service | `http://vlm-inference:8002` |
| `ADAPTER_SERVICE_URL` | URL Adapter Service | `http://adapter:8001` |
| `REQUEST_TIMEOUT` | –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–µ–∫—É–Ω–¥—ã) | `120` |

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

**–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**
```
============================================================
üöÄ –ó–∞–ø—É—Å–∫ Backend API Service
============================================================
üîó VLM Service: http://vlm-inference:8002
üîó Adapter Service: http://adapter:8001
‚è±Ô∏è  Request Timeout: 120s
============================================================
‚úÖ VLM Service –¥–æ—Å—Ç—É–ø–µ–Ω
‚úÖ Adapter Service –¥–æ—Å—Ç—É–ø–µ–Ω
‚úÖ Backend API –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
```

**–ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞:**
```
============================================================
üì• –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É
üìÑ –§–∞–π–ª: diagram.bpmn
üì¶ –¢–∏–ø: application/xml
‚úÖ –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: .bpmn
üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 45.23 KB
üîë –•—ç—à —Ñ–∞–π–ª–∞: a1b2c3d4e5f6...
üîÑ –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ .bpmn –≤ PNG
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Adapter Service...
‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ä–∞–∑–º–µ—Ä PNG: 125.43 KB
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ VLM Service –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è...
‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
‚úÖ –ó–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞ 12.34 —Å–µ–∫
============================================================
```

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
docker logs -f backend-api
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 400 Bad Request
- –§–∞–π–ª –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞

### 502 Bad Gateway
- –û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Adapter Service
- –û—à–∏–±–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –≤ VLM Service

### 503 Service Unavailable
- Adapter Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- VLM Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### 504 Gateway Timeout
- –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

### 500 Internal Server Error
- –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

## Workflow –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

```
1. –ö–ª–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª
   ‚Üì
2. Backend –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç
   ‚Üì
3. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ö—ç—à —Ñ–∞–π–ª–∞
   ‚Üì
4. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
   ‚Üì
5a. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:
    ‚Üí –í—ã–∑–æ–≤ Adapter Service
    ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ PNG
   ‚Üì
5b. –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞:
    ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª
   ‚Üì
6. –û—Ç–ø—Ä–∞–≤–∫–∞ PNG –≤ VLM Service
   ‚Üì
7. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞
   ‚Üì
8. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
   ‚Üì
9. –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Healthcheck

Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
docker ps  # –°–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç—É—Å –≤ –∫–æ–ª–æ–Ω–∫–µ STATUS
```

### –ú–µ—Ç—Ä–∏–∫–∏

–ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ —á–µ—Ä–µ–∑ API:
```bash
curl http://localhost:8000/metrics
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ VLM Service
curl http://localhost:8002/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Adapter Service
curl http://localhost:8001/health
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è |
|----------|-------|
| PNG –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ | 7-10 —Å–µ–∫ |
| BPMN —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π | 10-15 —Å–µ–∫ |
| PlantUML —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π | 12-18 —Å–µ–∫ |

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–æ–±–∞–≤–∏—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ —Ö—ç—à—É —Ñ–∞–π–ª–∞
2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å (RabbitMQ/Kafka) –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–ø–ª–∏–∫ VLM Service
4. **–ö–æ–º–ø—Ä–µ—Å—Å–∏—è** - —Å–∂–∏–º–∞—Ç—å PNG –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ VLM

## Troubleshooting

### VLM Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** `503 Service Unavailable: VLM Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ VLM –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker ps | grep vlm`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ VLM: `docker logs vlm-inference`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: `docker network inspect <network_name>`
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `VLM_SERVICE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### Adapter Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** `503 Service Unavailable: Adapter Service –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Adapter –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω: `docker ps | grep adapter`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Adapter: `docker logs adapter`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `ADAPTER_SERVICE_URL` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### Timeout –æ—à–∏–±–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** `504 Gateway Timeout`

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á—å—Ç–µ `REQUEST_TIMEOUT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 120 —Å–µ–∫)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É VLM Service (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω)
3. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** `400 Bad Request: –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç –≤ —Å–ø–∏—Å–∫–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö
3. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –≤ PNG –≤—Ä—É—á–Ω—É—é

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

Backend API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –º–µ–∂–¥—É:

- **Frontend** (UI Service) - –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Adapter Service** - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –¥–∏–∞–≥—Ä–∞–º–º—ã –≤ PNG
- **VLM Service** - —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –¥–∏–∞–≥—Ä–∞–º–º—ã

–°–º. –∫–æ—Ä–Ω–µ–≤–æ–π `docker-compose.yml` –¥–ª—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
cd app
pip install -r requirements.txt

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export VLM_SERVICE_URL=http://localhost:8002
export ADAPTER_SERVICE_URL=http://localhost:8001

# –ó–∞–ø—É—Å–∫
uvicorn main:app --reload --port 8000
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –¢–µ—Å—Ç —Å PNG —Ñ–∞–π–ª–æ–º
curl -X POST "http://localhost:8000/api/v1/process" \
  -F "file=@test.png"

# –¢–µ—Å—Ç —Å BPMN —Ñ–∞–π–ª–æ–º
curl -X POST "http://localhost:8000/api/v1/process" \
  -F "file=@test.bpmn"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
curl http://localhost:8000/health

# –ú–µ—Ç—Ä–∏–∫–∏
curl http://localhost:8000/metrics
```

## CORS

Backend –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ä–∞–∑—Ä–µ—à–∞—é—â–µ–π CORS –ø–æ–ª–∏—Ç–∏–∫–æ–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```python
allow_origins=["*"]
```

**–í –ø—Ä–æ–¥–∞–∫—à–Ω–µ** –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã:
```python
allow_origins=["https://yourdomain.com"]